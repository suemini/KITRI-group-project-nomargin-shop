<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<link rel="stylesheet" href="/CSS/detail.css">
</head>
<body>
<table>
    <div class="py-5 text-center">
        <h2>후기</h2>
    </div>
    <tr>
        <th>Review id</th>
        <td th:text="${review.id}"></td>
    </tr>
    <tr>
        <th>writer</th>
        <td th:text="${review.getReviewWriter()}"></td>
    </tr>
    <tr>
        <th>title</th>
        <td th:text="${review.getReviewTitle()}"></td>
    </tr>
    <tr>
        <th>contents</th>
        <td th:text="${review.getReviewContents()}"></td>
    </tr>
    <tr>
        <th>date</th>
        <td th:text="${review.reviewUpdatedTime != null ? #temporals.format(review.reviewUpdatedTime, 'yyyy-MM-dd HH:mm:ss') : #temporals.format(review.reviewCreatedTime, 'yyyy-MM-dd HH:mm:ss')}"></td>

    </tr>
    <tr>
        <th>hits</th>
        <td th:text="${review.getReviewHits()}"></td>
    </tr>
    <tr>
        <th>itemId</th>
        <td th:text="${review.getItemId()}"></td>
    </tr>
</table>
<button onclick="listReq()">목록</button>

<!-- 관리자와 글 작성자만 버튼이 보이도록 -->
<!--<button sec:authorize="hasAnyAuthority('ROLE_ADMIN')" onclick="updateReq()">수정</button>-->
<button sec:authorize="hasAnyAuthority('ROLE_ADMIN')" th:if="${#authentication.principal.username} == ${review.getReviewWriter()}" onclick="updateReq()">수정</button>
<!--<button sec:authorize="hasAnyAuthority('ROLE_ADMIN')" onclick="deleteReq()">삭제</button>-->
<button sec:authorize="hasAnyAuthority('ROLE_ADMIN')" th:if="${#authentication.principal.username} == ${review.getReviewWriter()}" onclick="deleteReq()">삭제</button>

</body>
<script th:inline="javascript">
    const listReq = () => {
        console.log("목록 요청");
        location.href = "/review";
    }
    const updateReq = () => {
        console.log("수정 요청");
        const id = [[${review.id}]];
        location.href = "/review/update/" + id;
    }
    const deleteReq = () => {
        console.log("삭제 요청");
        const id = [[${review.id}]];
        location.href = "/review/delete/" + id;
    }
</script>

</html>